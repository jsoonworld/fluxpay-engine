# FluxPay Engine - Executive Summary

> **Version**: 1.0 | **Status**: Draft | **Last Updated**: 2026-02-04
>
> For detailed specifications, see [Product Brief](./product-brief.md) and [Technical Specification](./tech-spec.md)

---

## 한 줄 요약

**어떤 서비스에도 붙일 수 있는 플러그인형 결제/과금 엔진**

---

## 해결하려는 문제

1. **반복되는 결제 시스템 구축** - 새로운 유료 기능마다 PG 연동, 멱등성 처리, 환불 로직을 처음부터 구현
2. **분산 환경 데이터 정합성** - 결제 성공 후 서비스 실패 시 수동 보정 필요
3. **트래픽 폭주 대응 부재** - 선착순 이벤트, 대규모 프로모션 시 시스템 다운

---

## 목표 사용자

| 사용자 | 니즈 |
|--------|------|
| 백엔드 개발자 | API 호출만으로 결제 기능 연동 |
| 프로덕트 매니저 | 다양한 과금 모델 빠른 실험 |
| 운영팀 | 결제 모니터링, 이상 거래 탐지 |

---

## 핵심 기능

| 기능 | 설명 |
|------|------|
| **주문** | 도메인 무관 주문 생성, 상태 추적 |
| **결제** | PG 연동, 승인/확정/환불, 안전한 재시도 |
| **크레딧** | 선불 충전, 사용량 차감, 차등 과금 |
| **구독** | 월/연정액, 자동 갱신, 무료 체험 |
| **트래픽 제어** | 대기열, 요청량 제한 |

---

## 성공 기준

| 지표 | 목표 |
|------|------|
| 결제 성공률 | 99.9% 이상 |
| 중복 결제 | 0건/월 |
| 장애 복구 | 30초 이내 |
| API 응답 | p95 < 200ms |
| 처리량 | 1,000 TPS 이상 |
| 연동 소요 | 1주일 이내 |

---

## 로드맵

| Phase | 목표 | 주요 내용 |
|-------|------|----------|
| **1** | 핵심 결제 | 주문/결제, PG 연동, 크레딧, API 문서화 |
| **2** | 안정성 | 이벤트 아키텍처, 분산 트랜잭션, Saga |
| **3** | 확장성 | 대기열, 요청 제한, 구독, 부하 테스트 |
| **4** | 운영 | 대시보드, 알림, 분산 추적, SLA 리포트 |

---

## 범위 제외

정산/대사, 세금계산서, 차지백 처리, 멀티 PG, 해외 결제는 현재 범위 외 (향후 확장 예정)

---

## 연동 방식

```
[클라이언트] ─REST API─▶ [FluxPay Engine] ─▶ [PG: 토스페이먼츠]
                              │
                    이벤트 알림 ▼
                         [클라이언트]
```

- **요청**: REST API + `X-Idempotency-Key`
- **알림**: CloudEvents 스트리밍
- **지원**: Java/Kotlin SDK 제공

---

*Last Updated: 2026-02-04*
